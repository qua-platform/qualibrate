
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="QM. Technologies Ltd.">
      
      
      
        <link rel="prev" href="../calibration_library/">
      
      
        <link rel="next" href="../advanced_calibration_graphs/">
      
      
        
      
      
      <link rel="icon" href="../assets/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Calibration Graphs - QUAlibrate Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="qualibrate-bright" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#calibration-graphs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="QUAlibrate Documentation" class="md-header__button md-logo" aria-label="QUAlibrate Documentation" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QUAlibrate Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Calibration Graphs
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="qualibrate-bright" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to high contrast mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to high contrast mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="qualibrate-high-contrast" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18V6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="qualibrate-dark" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="QUAlibrate Documentation" class="md-nav__button md-logo" aria-label="QUAlibrate Documentation" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    QUAlibrate Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation Guide
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../calibration_nodes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Calibration Nodes
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../calibration_library/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Calibration Library
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Calibration Graphs
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Calibration Graphs
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#graph-execution-using-targets-and-an-orchestrator" class="md-nav__link">
    <span class="md-ellipsis">
      
        Graph Execution Using Targets and an Orchestrator
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qualibrationnode-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        QualibrationNode Requirements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QualibrationNode Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#specifying-node-targets-qubits" class="md-nav__link">
    <span class="md-ellipsis">
      
        Specifying Node Targets (Qubits)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Specifying Node Targets (Qubits)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adding-node-outcome-per-target" class="md-nav__link">
    <span class="md-ellipsis">
      
        Adding Node Outcome per Target
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-qualibrationgraph" class="md-nav__link">
    <span class="md-ellipsis">
      
        Creating a QualibrationGraph
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Creating a QualibrationGraph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-creating-a-qualibrationgraph" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Creating a QualibrationGraph
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#importing-qualibrate" class="md-nav__link">
    <span class="md-ellipsis">
      
        Importing qualibrate
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loading-the-calibration-library" class="md-nav__link">
    <span class="md-ellipsis">
      
        Loading the Calibration Library
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defining-graph-input-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Defining Graph Input Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constructing-the-qualibrationgraph" class="md-nav__link">
    <span class="md-ellipsis">
      
        Constructing the QualibrationGraph
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-the-qualibrationgraph" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running the QualibrationGraph
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#full-qualibrationgraph-file" class="md-nav__link">
    <span class="md-ellipsis">
      
        Full QualibrationGraph File
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qualibrationorchestrator" class="md-nav__link">
    <span class="md-ellipsis">
      
        QualibrationOrchestrator
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="QualibrationOrchestrator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basicorchestrator" class="md-nav__link">
    <span class="md-ellipsis">
      
        BasicOrchestrator
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced_calibration_graphs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced Calibration Graphs
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../web_app/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Web App
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../projects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Projects
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration File
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Additional features
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    Additional features
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../node_actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Node Actions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../release_notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Release Notes
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="calibration-graphs">Calibration Graphs</h1>
<h2 id="introduction">Introduction</h2>
<p>Tuning up a qubit or multiple qubits in a quantum processing unit (QPU) involves executing a sequence of calibration nodes. The next calibration node to be executed may depend on the measurement outcome of one or more previous nodes, allowing for adaptive decision-making based on previous results, which is crucial for efficient calibration. This process is called a calibration routine and can be represented using a directed acyclic graph (DAG) together with an orchestrator.</p>
<p>In QUAlibrate, a <code>QualibrationGraph</code> is used to represent these calibration routines. The nodes in the DAG are <code>QualibrationNode</code> instances, and the edges between nodes determine the execution order: a destination node can only be executed once its origin node has successfully completed.</p>
<div class="admonition tip">
<p class="admonition-title">Advanced Features</p>
</div>
<p>This guide covers the basics of creating and running calibration graphs. For advanced features including looping, failure handling, and nested subgraphs, see <a href="../advanced_calibration_graphs/">Advanced Calibration Graphs</a>.</p>
<h2 id="graph-execution-using-targets-and-an-orchestrator">Graph Execution Using Targets and an Orchestrator</h2>
<p>To execute a calibration graph, two key elements are required: the <code>targets</code> and the orchestrator. Targets specify what is being calibrated, while the orchestrator manages the execution sequence.</p>
<p>The <code>targets</code> specify the entities to which the graph should be applied, typically qubits. These targets allow the calibration nodes to understand which parts of the quantum system they should act upon.</p>
<p>The orchestrator, specifically a <code>QualibrationOrchestrator</code>, determines the sequence of node execution in the graph. It traverses the <code>QualibrationGraph</code>, deciding which <code>QualibrationNode</code> should be executed next based on the outcomes of previous nodes. The orchestrator ensures that nodes are executed in the correct order and selects which targets (e.g., qubits) should be used for each node.</p>
<p>Due to the dependencies between nodes, orchestrating their execution can be complex. The complexity arises from the need to account for varying outcomes and ensure that all dependencies are satisfied. As a result, there is no single optimal <code>QualibrationOrchestrator</code>. Different types of orchestrators can be used, each focusing on specific properties such as simplicity, reliability, or efficiency.</p>
<h2 id="qualibrationnode-requirements"><code>QualibrationNode</code> Requirements</h2>
<p>To be used within a <code>QualibrationGraph</code>, a <code>QualibrationNode</code> must meet certain requirements.</p>
<h3 id="specifying-node-targets-qubits">Specifying Node Targets (Qubits)</h3>
<p>The first requirement is to specify the targets for the node. By default, these targets are <code>qubits</code>, meaning that <code>qubits</code> should be defined as one of the parameters for the node:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">List</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qualibrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">NodeParameters</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Parameters</span><span class="p">(</span><span class="n">NodeParameters</span><span class="p">):</span>
    <span class="n">qubits</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Include other parameters here</span>
</code></pre></div>
<p>This setup indicates that the <code>QualibrationNode</code> can receive a list of qubits as targets for calibration.</p>
<details>
<summary>Using <code>targets</code> other than <code>qubits</code></summary>
<p>By default, the <code>targets</code> parameter is set to <code>qubits</code>, as this is the most common use case for calibrations. However, the <code>targets</code> can be modified to accommodate different types by changing the class variable <code>Parameters.targets_name</code>. For example, if the node performs calibration on qubit pairs rather than individual qubits, it can be specified as follows:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClassVar</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">List</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Parameters</span><span class="p">(</span><span class="n">NodeParameters</span><span class="p">):</span>
    <span class="n">targets_name</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;qubit_pairs&quot;</span>
    <span class="n">qubit_pairs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Include other parameters here</span>
</code></pre></div>
</details>
<div class="admonition note">
<p class="admonition-title">Targets Type</p>
</div>
<p>Currently, each target is expected to be of type <code>str</code>. Therefore, the <code>targets</code> parameter type should be <code>Optional[List[str]]</code> with a default value of <code>None</code>. In the future, support for additional types will be added.</p>
<h4 id="adding-node-outcome-per-target">Adding Node Outcome per Target</h4>
<p>A <code>QualibrationNode</code> must also indicate the calibration outcome for each target. This is essential for deciding the subsequent calibration steps based on success or failure. This is important for determining subsequent steps based on which targets were calibrated successfully and which ones failed. For instance, if the node was executed with the parameter <code>qubits = ["q0", "q1"]</code>, then the outcomes can be set as follows:</p>
<div class="highlight"><pre><span></span><code><span class="n">node</span><span class="o">.</span><span class="n">outcomes</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;q0&quot;</span><span class="p">:</span> <span class="s2">&quot;successful&quot;</span><span class="p">,</span>
    <span class="s2">&quot;q1&quot;</span><span class="p">:</span> <span class="s2">&quot;failed&quot;</span><span class="p">,</span>
<span class="p">}</span>
</code></pre></div>
<p>The <code>outcomes</code> attribute is crucial for guiding the next steps in the calibration process. If no outcome is provided, the <code>QualibrationOrchestrator</code> assumes that the node was successful for all targets.</p>
<h2 id="creating-a-qualibrationgraph">Creating a QualibrationGraph</h2>
<p>Similar to a <code>QualibrationNode</code>, a <code>QualibrationGraph</code> should be defined in a dedicated Python script and saved in the <code>qualibrate_runner.calibration_library_folder</code> path specified in the <a href="../configuration/">configuration file</a>.</p>
<h3 id="example-creating-a-qualibrationgraph">Example: Creating a <code>QualibrationGraph</code></h3>
<p>In this example, we will create a graph composed of three <code>QualibrationNode</code>s: qubit spectroscopy → Rabi → Ramsey. The arrow indicates that each subsequent node can only be executed if the previous node had a successful outcome for that target.</p>
<div class="admonition note">
<p class="admonition-title">Demo Calibration Nodes</p>
</div>
<p>This example uses demo calibration nodes that are automatically installed with QUAlibrate in the project <code>"demo_project"</code>. These nodes (<code>01_demo_qubit_spectroscopy</code>, <code>02_demo_rabi</code>, <code>05_demo_ramsey</code>) are available in the calibration library and can be used for testing and learning purposes.</p>
<h3 id="importing-qualibrate">Importing <code>qualibrate</code></h3>
<p>The first step is to import the relevant classes from <code>qualibrate</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qualibrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">QualibrationLibrary</span><span class="p">,</span> <span class="n">QualibrationGraph</span><span class="p">,</span> <span class="n">GraphParameters</span>
</code></pre></div>
<h3 id="loading-the-calibration-library">Loading the Calibration Library</h3>
<p>The next step is to load the calibration library:</p>
<div class="highlight"><pre><span></span><code><span class="n">library</span> <span class="o">=</span> <span class="n">QualibrationLibrary</span><span class="o">.</span><span class="n">get_active_library</span><span class="p">()</span>
</code></pre></div>
<p>This will scan the library folder and load all existing nodes and graphs, which allows us to use the nodes in the graph.</p>
<h3 id="defining-graph-input-parameters">Defining Graph Input Parameters</h3>
<p>Next, define the graph parameters. Typically, this only consists of the graph targets, which are <code>qubits</code> by default:</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Parameters</span><span class="p">(</span><span class="n">GraphParameters</span><span class="p">):</span>
    <span class="n">qubits</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div>
<h3 id="constructing-the-qualibrationgraph">Constructing the <code>QualibrationGraph</code></h3>
<p>Now we are ready to create the <code>QualibrationGraph</code> using the context manager API:</p>
<div class="highlight"><pre><span></span><code><span class="k">with</span> <span class="n">QualibrationGraph</span><span class="o">.</span><span class="n">build</span><span class="p">(</span>
    <span class="s2">&quot;workflow1&quot;</span><span class="p">,</span>
    <span class="n">parameters</span><span class="o">=</span><span class="n">Parameters</span><span class="p">(),</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">graph</span><span class="p">:</span>
    <span class="c1"># Get nodes from the library (automatically copied)</span>
    <span class="n">qubit_spec</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s2">&quot;01_demo_qubit_spectroscopy&quot;</span><span class="p">]</span>
    <span class="n">rabi</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s2">&quot;02_demo_rabi&quot;</span><span class="p">]</span>
    <span class="n">ramsey</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s2">&quot;05_demo_ramsey&quot;</span><span class="p">]</span>

    <span class="c1"># Add nodes to the graph</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">qubit_spec</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">rabi</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">ramsey</span><span class="p">)</span>

    <span class="c1"># Connect nodes to define execution order</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">qubit_spec</span><span class="p">,</span> <span class="n">rabi</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">rabi</span><span class="p">,</span> <span class="n">ramsey</span><span class="p">)</span>
</code></pre></div>
<p>Here is an explanation of each part:</p>
<ul>
<li><code>QualibrationGraph.build()</code>: Creates a graph in building mode using a context manager</li>
<li><code>name</code>: Unique name for the <code>QualibrationGraph</code>, used by the <code>QualibrationLibrary</code> to index the graph</li>
<li><code>parameters</code>: An instance of the previously defined <code>Parameters</code> class</li>
<li><code>library.nodes["..."]</code>: Retrieves nodes from the library (automatically creating copies)</li>
<li><code>graph.add_node()</code>: Adds a node to the graph</li>
<li><code>graph.connect()</code>: Defines edges between nodes, where the destination node executes after the source node succeeds</li>
</ul>
<p>When the <code>with</code> block exits, the graph is automatically finalized and validated.</p>
<h3 id="running-the-qualibrationgraph">Running the QualibrationGraph</h3>
<p>After creating the graph, it can be executed as follows:</p>
<div class="highlight"><pre><span></span><code><span class="n">graph</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qubits</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;q1&quot;</span><span class="p">,</span> <span class="s2">&quot;q2&quot;</span><span class="p">,</span> <span class="s2">&quot;q3&quot;</span><span class="p">])</span>
</code></pre></div>
<h3 id="full-qualibrationgraph-file">Full <code>QualibrationGraph</code> File</h3>
<p>Combining all the elements from the previous sections, the final script containing the <code>QualibrationGraph</code> looks like this:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qualibrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">QualibrationLibrary</span><span class="p">,</span> <span class="n">QualibrationGraph</span><span class="p">,</span> <span class="n">GraphParameters</span>

<span class="n">library</span> <span class="o">=</span> <span class="n">QualibrationLibrary</span><span class="o">.</span><span class="n">get_active_library</span><span class="p">()</span>

<span class="c1"># Define graph target parameters</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Parameters</span><span class="p">(</span><span class="n">GraphParameters</span><span class="p">):</span>
    <span class="n">qubits</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># Create the QualibrationGraph using the context manager</span>
<span class="k">with</span> <span class="n">QualibrationGraph</span><span class="o">.</span><span class="n">build</span><span class="p">(</span>
    <span class="s2">&quot;workflow1&quot;</span><span class="p">,</span>  <span class="c1"># Unique graph name</span>
    <span class="n">parameters</span><span class="o">=</span><span class="n">Parameters</span><span class="p">(),</span>  <span class="c1"># Instantiate graph parameters</span>
<span class="p">)</span> <span class="k">as</span> <span class="n">graph</span><span class="p">:</span>
    <span class="c1"># Get demo nodes from the library (automatically copied)</span>
    <span class="n">qubit_spec</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s2">&quot;01_demo_qubit_spectroscopy&quot;</span><span class="p">]</span>
    <span class="n">rabi</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s2">&quot;02_demo_rabi&quot;</span><span class="p">]</span>
    <span class="n">ramsey</span> <span class="o">=</span> <span class="n">library</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="s2">&quot;05_demo_ramsey&quot;</span><span class="p">]</span>

    <span class="c1"># Add nodes to the graph</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">qubit_spec</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">rabi</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">ramsey</span><span class="p">)</span>

    <span class="c1"># Connect nodes to define execution order</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">qubit_spec</span><span class="p">,</span> <span class="n">rabi</span><span class="p">)</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">rabi</span><span class="p">,</span> <span class="n">ramsey</span><span class="p">)</span>

<span class="c1"># Run the calibration graph for qubits q1, q2, and q3</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">qubits</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;q1&quot;</span><span class="p">,</span> <span class="s2">&quot;q2&quot;</span><span class="p">,</span> <span class="s2">&quot;q3&quot;</span><span class="p">])</span>
</code></pre></div>
<p>This script can be executed from any IDE or terminal. Additionally, it can also be run from the <a href="../web_app/">QUAlibrate Web App</a>, provided it is saved in the <code>qualibrate_runner.calibration_library_folder</code> path specified in the <a href="../configuration/">configuration file</a>.</p>
<h2 id="qualibrationorchestrator">QualibrationOrchestrator</h2>
<p>The <code>QualibrationOrchestrator</code> is responsible for running a <code>QualibrationGraph</code>, i.e. deciding which <code>QualibrationNode</code> to execute next and what <code>targets</code> (e.g. qubits) should be calibrated in that node.
This decision process typically relies on the node outcomes of executed nodes.
The choices that a <code>QualibrationOrchestrator</code> makes include</p>
<ul>
<li>What should happen to a target if its calibration failed in a node? Should it be dropped from further calibrations, or should the failed calibration be remedied, for example by attempting the same or a previous calibration again?</li>
<li>If multiple calibration nodes can be executed next, which one has priority?</li>
<li>Should the next <code>QualibrationNode</code> run on multiple targets simultaneously, or on one at a time?</li>
</ul>
<p>There is no single right answer to this question, and therefore different subclasses of <code>QualibrationOrchestrator</code> are created that implement different graph traversal algorithm.
Currently, QUAlibrate has the <code>BasicOrchestrator</code> that implements a straightforward graph traversal.
Additional orchestrators will be added to QUAlibrate in the future, and users can also implement custom graph traversal algorithms by subclassing the <code>QualibrationOrchestrator</code>.</p>
<h3 id="basicorchestrator">BasicOrchestrator</h3>
<p>The <code>BasicOrchestrator</code> is a straightforward graph traversal algorithm with a single parameter <code>skip_failed</code>, which determines whether to continue calibrating failed targets.
The functionality of this algorithm is described here.</p>
<ol>
<li>For each target, collect all nodes that have not yet been executed and whose predecessors have been executed.</li>
<li>Run each of these nodes, grouping targets together that are executed on the same node.
   If a node outcome <code>failed</code> for a target, then the action depends on <code>skip_failed</code>:
   a. <code>skip_failed = True</code> → Remove the target from any further calibrations
   b. <code>skip_failed = False</code> → ignore the node outcome and keep using the target for further calibration.</li>
<li>Repeat 1 and 2 until the list of nodes in Step 1 is empty.</li>
</ol>
<p>The <code>BasicOrchestrator</code> can be instantiated as follows:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">qualibrate.orchestration.basic_orchestrator</span><span class="w"> </span><span class="kn">import</span> <span class="n">BasicOrchestrator</span>

<span class="n">orchestrator</span> <span class="o">=</span> <span class="n">BasicOrchestrator</span><span class="p">(</span><span class="n">skip_failed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Q.M Technologies Ltd.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.top", "toc.integrate", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotations", "content.code.copy", "content.code.annotate"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>