
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="QM. Technologies Ltd.">
      
      
      
        <link rel="prev" href="../configuration/">
      
      
      
      <link rel="icon" href="../assets/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Node Actions - QUAlibrate Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="qualibrate-bright" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#node-actions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="QUAlibrate Documentation" class="md-header__button md-logo" aria-label="QUAlibrate Documentation" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            QUAlibrate Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Node Actions
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="qualibrate-bright" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to high contrast mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to high contrast mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="qualibrate-high-contrast" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18V6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="qualibrate-dark" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="QUAlibrate Documentation" class="md-nav__button md-logo" aria-label="QUAlibrate Documentation" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    QUAlibrate Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../calibration_nodes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Calibration Nodes
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../calibration_library/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Calibration Library
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../calibration_graphs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Calibration Graphs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../web_app/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Web App
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../projects/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Projects
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration File
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Additional features
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Additional features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Node Actions
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Node Actions
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structuring-nodes-with-actions" class="md-nav__link">
    <span class="md-ellipsis">
      Structuring Nodes with Actions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sharing-data-between-actions" class="md-nav__link">
    <span class="md-ellipsis">
      Sharing Data Between Actions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#controlling-execution-flow-with-skip_if" class="md-nav__link">
    <span class="md-ellipsis">
      Controlling Execution Flow with skip_if
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#benefits-of-using-node-actions" class="md-nav__link">
    <span class="md-ellipsis">
      Benefits of Using Node Actions
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="node-actions">Node Actions</h1>
<h2 id="introduction">Introduction</h2>
<p>Node Actions provide a structured way to organize the code within a
<code>QualibrationNode</code> while preserving the interactivity essential for
calibration tasks. Traditionally, calibration scripts might be long,
monolithic files or broken into functions without a standardized execution
flow. Node Actions introduce a lightweight mechanism using decorators to
define distinct, executable steps within a node script.</p>
<p>This approach aims to balance the need for clear, maintainable code
structure with the flexibility required for debugging and iterative
development common in quantum calibration workflows. It addresses the
challenge that overly rigid structures can hinder the quick experimentation
needed when tuning quantum systems.</p>
<h2 id="structuring-nodes-with-actions">Structuring Nodes with Actions</h2>
<p>The core of this feature is the <code>@node.run_action</code> decorator. By applying
this decorator to a function within a <code>QualibrationNode</code> script, you
designate that function as a "Node Action."</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">qualibrate</span><span class="w"> </span><span class="kn">import</span> <span class="n">QualibrationNode</span><span class="p">,</span> <span class="n">NodeParameters</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span> <span class="c1"># Added for Optional type hint</span>

<span class="c1"># Define Parameters (assuming Parameters class exists)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Parameters</span><span class="p">(</span><span class="n">NodeParameters</span><span class="p">):</span>
    <span class="c1"># ... node parameters</span>
    <span class="n">simulate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">load_data_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<span class="c1"># Instantiate the node</span>
<span class="n">node</span> <span class="o">=</span> <span class="n">QualibrationNode</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;example_node&quot;</span><span class="p">,</span>
    <span class="n">parameters</span><span class="o">=</span><span class="n">Parameters</span><span class="p">()</span>
<span class="p">)</span>
<span class="c1"># Node setup might occur here, e.g., loading configurations or machine state if needed</span>

<span class="c1"># Define an action</span>
<span class="nd">@node</span><span class="o">.</span><span class="n">run_action</span>
<span class="k">def</span><span class="w"> </span><span class="nf">save_results</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">QualibrationNode</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves the node&#39;s results.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saving results...&quot;</span><span class="p">)</span>
    <span class="c1"># Add logic to gather results if needed before saving</span>
    <span class="n">node</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Results saved.&quot;</span><span class="p">)</span>

<span class="c1"># &gt;&gt; Output when script is run:</span>
<span class="c1"># Saving results...</span>
<span class="c1"># Results saved.</span>
</code></pre></div>
<p>When the Python script containing the node is executed (either directly, via
the Calibration Library, or the Web App), functions decorated with
<code>@node.run_action</code> are:</p>
<ol>
<li><strong>Executed Immediately:</strong> The function runs as soon as it's defined in
    the script flow.</li>
<li><strong>Registered:</strong> The action is registered with the node instance, making it
    potentially available for more advanced control flows or debugging tools
    in the future (like re-running specific steps).</li>
</ol>
<h2 id="sharing-data-between-actions">Sharing Data Between Actions</h2>
<p>Since actions are distinct functions, you need a way to pass data generated
in one action to another action executed later in the script. The
<code>node.namespace</code> attribute serves this purpose. It is a dictionary attached
to the <code>node</code> object where you can store and retrieve variables.</p>
<p>You can directly assign values to keys in <code>node.namespace</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Inside an action function:</span>
<span class="n">intermediate_result</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">node</span><span class="o">.</span><span class="n">namespace</span><span class="p">[</span><span class="s2">&quot;my_result&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">intermediate_result</span>
</code></pre></div>
<p>In a subsequent action, you can access this stored value:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Inside a later action function:</span>
<span class="n">previous_result</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">namespace</span><span class="p">[</span><span class="s2">&quot;my_result&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The previous result was: </span><span class="si">{</span><span class="n">previous_result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<p>As a convenience, if an action function returns a dictionary, the contents of
that dictionary are automatically added to <code>node.namespace</code>. Keys from the
returned dictionary will overwrite existing keys in the namespace if they
collide.</p>
<p><strong>Example: Using <code>node.namespace</code></strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># In your QualibrationNode script...</span>

<span class="c1"># %% {Generate_Data}</span>
<span class="nd">@node</span><span class="o">.</span><span class="n">run_action</span>
<span class="k">def</span><span class="w"> </span><span class="nf">generate_data</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">QualibrationNode</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generates some data and stores it.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generating data...&quot;</span><span class="p">)</span>
    <span class="n">raw_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
    <span class="c1"># Store directly in namespace</span>
    <span class="n">node</span><span class="o">.</span><span class="n">namespace</span><span class="p">[</span><span class="s2">&quot;raw_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw_data</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Raw data stored in namespace.&quot;</span><span class="p">)</span>
    <span class="c1"># Return a dict to add more items to namespace</span>
    <span class="c1"># The following is equivalent to: node.namespace[&quot;processing_factor&quot;] = 10</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;processing_factor&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>

<span class="c1"># %% {Process_Data}</span>
<span class="nd">@node</span><span class="o">.</span><span class="n">run_action</span>
<span class="k">def</span><span class="w"> </span><span class="nf">process_data</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">QualibrationNode</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Processes data retrieved from the namespace.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Processing data...&quot;</span><span class="p">)</span>
    <span class="c1"># Retrieve data stored directly</span>
    <span class="n">retrieved_raw_data</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">namespace</span><span class="p">[</span><span class="s2">&quot;raw_data&quot;</span><span class="p">]</span>
    <span class="c1"># Retrieve data added via return dict</span>
    <span class="n">factor</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">namespace</span><span class="p">[</span><span class="s2">&quot;processing_factor&quot;</span><span class="p">]</span>
    <span class="n">processed_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="n">factor</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">retrieved_raw_data</span><span class="p">]</span>
    <span class="n">node</span><span class="o">.</span><span class="n">namespace</span><span class="p">[</span><span class="s2">&quot;processed_data&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">processed_data</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processed data: </span><span class="si">{</span><span class="n">processed_data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># %% {Use_Processed_Data}</span>
<span class="nd">@node</span><span class="o">.</span><span class="n">run_action</span>
<span class="k">def</span><span class="w"> </span><span class="nf">use_processed_data</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">QualibrationNode</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Uses the final processed data.&quot;&quot;&quot;</span>
    <span class="n">final_data</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">namespace</span><span class="p">[</span><span class="s2">&quot;processed_data&quot;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using final data: </span><span class="si">{</span><span class="n">final_data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># ... further steps ...</span>
</code></pre></div>
<p>This mechanism allows for a clear flow of data between the modular steps
defined by your node actions.</p>
<h2 id="controlling-execution-flow-with-skip_if">Controlling Execution Flow with <code>skip_if</code></h2>
<p>Node Actions allow for conditional execution using keyword arguments in the
decorator. The primary implemented control mechanism is the <code>skip_if</code>
argument.</p>
<p>If the expression passed to <code>skip_if</code> evaluates to <code>True</code>, the action will be
skipped during execution. This avoids complex <code>if/else</code> blocks cluttering the
main script body.</p>
<p><strong>Example: Skipping Simulation or Execution</strong></p>
<p>In a typical calibration node, you might want different execution paths:
simulate a process, execute it on hardware, or load previously saved
data. Node Actions with <code>skip_if</code> can manage this cleanly:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># In your QualibrationNode script...</span>

<span class="c1"># %% {Simulate_Process}</span>
<span class="nd">@node</span><span class="o">.</span><span class="n">run_action</span><span class="p">(</span>
    <span class="n">skip_if</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">load_data_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">or</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">simulate</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">simulate_process</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">QualibrationNode</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simulate the calibration process&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulating process...&quot;</span><span class="p">)</span>
    <span class="c1"># ... simulation logic ...</span>
    <span class="c1"># Example: Store simulation results</span>
    <span class="c1"># node.results[&quot;simulation&quot;] = {&quot;figure&quot;: fig, ...}</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulation complete.&quot;</span><span class="p">)</span>

<span class="c1"># %% {Execute_Process}</span>
<span class="nd">@node</span><span class="o">.</span><span class="n">run_action</span><span class="p">(</span>
    <span class="n">skip_if</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">load_data_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="ow">or</span> <span class="n">node</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">simulate</span>
<span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">execute_process</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">QualibrationNode</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Execute the process and fetch the raw data.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Executing process...&quot;</span><span class="p">)</span>
    <span class="c1"># ... execution logic ...</span>
    <span class="c1"># Example: Store raw data</span>
    <span class="c1"># node.results[&quot;ds_raw&quot;] = dataset</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Execution complete.&quot;</span><span class="p">)</span>

<span class="c1"># %% {Load_Data}</span>
<span class="nd">@node</span><span class="o">.</span><span class="n">run_action</span><span class="p">(</span><span class="n">skip_if</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">load_data_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">QualibrationNode</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a previously acquired dataset.&quot;&quot;&quot;</span>
    <span class="n">load_data_id</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">load_data_id</span> <span class="c1"># Store before node is overwritten</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loading data from ID: </span><span class="si">{</span><span class="n">load_data_id</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="c1"># Load the specified dataset - Note: this populates the node variable</span>
    <span class="n">node</span><span class="o">.</span><span class="n">load_from_id</span><span class="p">(</span><span class="n">load_data_id</span><span class="p">)</span>
    <span class="c1"># Restore the parameter if needed, as load_from_id might reset it</span>
    <span class="n">node</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">load_data_id</span> <span class="o">=</span> <span class="n">load_data_id</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data loaded.&quot;</span><span class="p">)</span>

<span class="c1"># %% {Analyse_Data}</span>
<span class="nd">@node</span><span class="o">.</span><span class="n">run_action</span><span class="p">(</span><span class="n">skip_if</span><span class="o">=</span><span class="n">node</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">simulate</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">analyse_data</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">QualibrationNode</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Analyse the raw or loaded data.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Analysing data...&quot;</span><span class="p">)</span>
    <span class="c1"># ... analysis logic ...</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Analysis complete.&quot;</span><span class="p">)</span>

<span class="c1"># %% {Save_Results}</span>
<span class="nd">@node</span><span class="o">.</span><span class="n">run_action</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">save_results</span><span class="p">(</span><span class="n">node</span><span class="p">:</span> <span class="n">QualibrationNode</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Saves the node&#39;s results.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saving results...&quot;</span><span class="p">)</span>
    <span class="n">node</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Results saved.&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Using <code># %% {Cell Name}</code> comments before each action allows editors like
VS Code to recognize these sections as runnable cells. This simplifies
debugging and interactive execution of specific actions within a compatible
kernel.</p>
<p>In this example:</p>
<ul>
<li><code>simulate_process</code> only runs if <code>load_data_id</code> is <code>None</code> AND
  <code>simulate</code> is <code>True</code>.</li>
<li><code>execute_process</code> only runs if <code>load_data_id</code> is <code>None</code> AND
  <code>simulate</code> is <code>False</code>.</li>
<li><code>load_data</code> only runs if <code>load_data_id</code> is provided.</li>
<li><code>analyse_data</code> runs if <code>simulate</code> is <code>False</code> (meaning we either executed
  or loaded data).</li>
<li><code>save_results</code> always runs at the end.</li>
</ul>
<h2 id="benefits-of-using-node-actions">Benefits of Using Node Actions</h2>
<p>Using Node Actions significantly improves the clarity and maintainability
of calibration scripts. Encapsulating logic in named functions makes scripts
easier to read and modify, while the decorator handles conditional execution
cleanly, avoiding complex <code>if</code> statements.</p>
<p>Furthermore, actions function as largely independent units. Explicitly
sharing data between them using <code>node.namespace</code> reduces implicit coupling
compared to scripts relying on shared local variables. This modularity and
reduced coupling lead to cleaner code and provide essential hooks for future
enhancements, such as interactively re-running steps or building custom
workflows, leading to more robust calibration nodes within the QUAlibrate
framework.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Q.M Technologies Ltd.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.top", "toc.integrate", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotations", "content.code.copy", "content.code.annotate"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>